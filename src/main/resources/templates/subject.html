<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>과목 관리</title>
</head>
<body>
<h1>과목 관리</h1>

<h2>과목 추가</h2>
<form id="subjectForm" method="post">
    <label for="name">강의명:</label>
    <input type="text" id="name" name="name" required><br><br>

    <label for="classTime">강의 시간:</label>
    <input type="text" id="classTime" name="classTime" required><br><br>

    <label for="professor">교수명:</label>
    <input type="text" id="professor" name="professor" required><br><br>

    <label for="lectureNumber">강좌번호:</label>
    <input type="text" id="lectureNumber" name="lectureNumber" required><br><br>

    <label for="dayWeek">요일:</label>
    <input type="text" id="dayWeek" name="dayWeek" required><br><br>

    <button type="submit">과목 추가</button>
</form>

<h2>모든 과목 정보</h2>
<div id="subject-list">과목정보</div>

<script>
    async function loadSubjects() {
        const response = await fetch('/subjects');
        const subjects = await response.json();

        const subjectList = document.getElementById('subject-list');
        subjectList.innerHTML = '';

        if (subjects.length === 0) {
            subjectList.innerHTML = '<p>등록된 과목이 없습니다.</p>';
        } else {
            const ul = document.createElement('ul');
            subjects.forEach(subject => {
                const li = document.createElement('li');
                li.textContent = `강의명: ${subject.name}, 강의 시간: ${subject.classTime}, 교수명: ${subject.professor}, 강좌번호: ${subject.lectureNumber}, 요일: ${subject.dayWeek}`;
                ul.appendChild(li);
            });
            subjectList.appendChild(ul);
        }
    }

    document.getElementById('subjectForm').onsubmit = async function(event) {
        event.preventDefault(); // 기본 폼 제출 방지

        const formData = new FormData(event.target);
        const subject = {};
        formData.forEach((value, key) => {
            subject[key] = value;
        });

        const response = await fetch('/subjects/add', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(subject)
        });

        if (response.ok) {
            const message = await response.text();
            alert(message);
            loadSubjects(); // 과목 추가 후 목록 새로 고침
        } else {
            alert('과목 추가 실패: ' + response.statusText);
        }
    };

    // 페이지 로드 시 모든 과목 정보 로드
    loadSubjects();
</script>
</body>
</html>
